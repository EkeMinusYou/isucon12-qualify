
# 4.5s user time, 20ms system time, 34.83M rss, 389.87G vsz
# Current date: Mon Nov  6 01:38:34 2023
# Hostname: YusukenoMac-mini.local
# Files: slowquery/log/mysql-slow.log
# Overall: 127.33k total, 15 unique, 1.72k QPS, 0.79x concurrency ________
# Time range: 2023-11-05T16:36:08 to 2023-11-05T16:37:22
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time            58s     1us      2s   458us     1ms     8ms    52us
# Lock time          909ms       0     6ms     7us     1us    86us       0
# Rows sent          1.20M       0   4.88k    9.92   24.84  147.77       0
# Rows examine      22.20M       0   3.08M  182.85  381.65   8.99k       0
# Query size         5.32M      27     152   43.78  136.99   29.00   31.70

# Profile
# Rank Query ID                            Response time Calls R/Call V/M 
# ==== =================================== ============= ===== ====== ====
#    1 0x676347F321DB8BC7FCB05D4948FC2248  37.1487 63.7%  7421 0.0050  0.09 SELECT visit_history
#    2 0x94A9E43DFAAFA029A1FC19A5563AD0F5  11.8246 20.3% 23173 0.0005  0.00 REPLACE id_generator
#    3 0xDA556F9115773A1A99AA0165670CE848   3.6905  6.3% 41820 0.0001  0.00 ADMIN PREPARE
#    4 0x3289E87E94D5A82E348974B3D332E575   2.3934  4.1%     1 2.3934  0.00 DELETE visit_history
#    5 0x2E69352DE16B15042A1217500A0400FE   1.3651  2.3%  2598 0.0005  0.00 INSERT visit_history
# MISC 0xMISC                               1.9389  3.3% 52315 0.0000   0.0 <10 ITEMS>

# Query 1: 106.01 QPS, 0.53x concurrency, ID 0x676347F321DB8BC7FCB05D4948FC2248 at byte 5919746
# Scores: V/M = 0.09
# Time range: 2023-11-05T16:36:12 to 2023-11-05T16:37:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5    7421
# Exec time     63     37s   119us   421ms     5ms     7ms    21ms     2ms
# Lock time      1    11ms       0   103us     1us     1us     3us     1us
# Rows sent     99   1.19M       0   4.88k  168.59  183.58  591.04   76.28
# Rows examine  86  19.11M       0  78.96k   2.64k   2.89k   9.30k   1.20k
# Query size    19   1.01M     141     144  142.90  136.99    0.61  136.99
# String:
# Databases    isuports
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ######################
#   1ms  ################################################################
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuports` LIKE 'visit_history'\G
#    SHOW CREATE TABLE `isuports`.`visit_history`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT player_id, MIN(created_at) AS min_created_at FROM visit_history WHERE tenant_id = 1 AND competition_id = '547f03113' GROUP BY player_id\G

# Query 2: 345.87 QPS, 0.18x concurrency, ID 0x94A9E43DFAAFA029A1FC19A5563AD0F5 at byte 29844954
# Scores: V/M = 0.00
# Time range: 2023-11-05T16:36:12 to 2023-11-05T16:37:19
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         18   23173
# Exec time     20     12s    96us    13ms   510us     2ms   672us   273us
# Lock time     96   879ms       0     6ms    37us   194us   199us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size    18 1018.34k      45      45      45      45       0      45
# String:
# Databases    isuports
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuports` LIKE 'id_generator'\G
#    SHOW CREATE TABLE `isuports`.`id_generator`\G
REPLACE INTO id_generator (stub) VALUES ('a')\G

# Query 3: 589.01 QPS, 0.05x concurrency, ID 0xDA556F9115773A1A99AA0165670CE848 at byte 28699497
# Scores: V/M = 0.00
# Time range: 2023-11-05T16:36:11 to 2023-11-05T16:37:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         32   41820
# Exec time      6      4s    15us    57ms    88us   214us   359us    54us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size    22   1.20M      30      30      30      30       0      30
# String:
# Databases    isuports
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  #########
#   1ms  #
#  10ms  #
# 100ms
#    1s
#  10s+
administrator command: Prepare\G

# Query 4: 0 QPS, 0x concurrency, ID 0x3289E87E94D5A82E348974B3D332E575 at byte 662
# Scores: V/M = 0.00
# Time range: all events occurred at 2023-11-05T16:36:10
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      4      2s      2s      2s      2s      2s       0      2s
# Lock time      0     5us     5us     5us     5us     5us       0     5us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine  13   3.08M   3.08M   3.08M   3.08M   3.08M       0   3.08M
# Query size     0      58      58      58      58      58       0      58
# String:
# Databases    isuports
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s  ################################################################
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuports` LIKE 'visit_history'\G
#    SHOW CREATE TABLE `isuports`.`visit_history`\G
DELETE FROM visit_history WHERE created_at >= '1654041600'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select * from  visit_history WHERE created_at >= '1654041600'\G

# Query 5: 38.21 QPS, 0.02x concurrency, ID 0x2E69352DE16B15042A1217500A0400FE at byte 24636782
# Scores: V/M = 0.00
# Time range: 2023-11-05T16:36:14 to 2023-11-05T16:37:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          2    2598
# Exec time      2      1s    92us    12ms   525us     2ms   784us   194us
# Lock time      0     4ms       0   826us     1us     1us    15us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     6 377.57k     147     150  148.82  143.84       0  143.84
# String:
# Databases    isuports
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  #########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuports` LIKE 'visit_history'\G
#    SHOW CREATE TABLE `isuports`.`visit_history`\G
INSERT INTO visit_history (player_id, tenant_id, competition_id, created_at, updated_at) VALUES ('9fa53b1e', 774, '9fa53ed6', 1699202229, 1699202229)\G
